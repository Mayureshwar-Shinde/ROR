= stylesheet_link_tag('paginator.css')

.container-fluid.row
  .col-md-10.mx-auto.case-card.shadow-sm{style: 'background-color: rgba(255,255,255,0.5)'}
    .display-6 Cases
    %hr.border-2
    = form_for :filter, url: cases_path, method: :get do |form|
      = form.label :status
      = form.select(:status, [['All', ''], ['Open','open'], ['In progress','in_progress'], ['Resolved','resolved'], ['Closed','closed']], {}, {class: "form-select d-inline me-4", style: "width:134px;"})
      = form.button(type: 'submit', class: 'btn btn-success') do
        %i.fa.fa-filter
        Filter

    %div.m-4
    %table.table.table-responsive.table-bordered.rounded-3.overflow-hidden
      %thead.table-dark
        %th= link_to 'Case no', sort: "case_number"
        %th= link_to 'Title', sort: 'title'
        %th= link_to 'Reported By', sort: 'first_name'
        - if case_manager_signed_in?
          %th= link_to 'Assigned To', sort: 'assigned_to'
        %th= link_to 'Status', sort: 'status'
        %th= link_to 'Created At', sort: 'created_at'
        %th= link_to 'Updated At', sort: 'updated_at'
      %tbody
        - @cases.each do |c|
          %tr
            %td
              %a{href: case_path(c)}
                = c.case_number
            %td= c.title
            %td= "#{c.user.first_name} #{c.user.last_name}"
            - if case_manager_signed_in?
              %td
                - if c.assigned_to_id.nil?
                  Not assigned
                - else
                  = "#{c.assigned_to.first_name} #{c.assigned_to.last_name}"
            %td
              - if c.status == 'in_progress'
                .text-warning
                  = c.status.capitalize
              - elsif c.status == 'resolved'
                .text-success
                  = c.status.capitalize
              - elsif c.status == 'open'
                .text-danger
                  = c.status.capitalize
              - else
                .text-secondary
                  = c.status.capitalize
            %td= c.created_at.strftime("%d %b %y, %l:%M%P")
            %td= c.updated_at.strftime("%d %b %y, %l:%M%P")
%br
%div.pagination-container
  .digg_pagination
    = will_paginate @cases, :container => false
%br
